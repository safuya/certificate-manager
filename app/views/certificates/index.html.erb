<h1>Certificates</h1>

<div class="search">
  <%= form_tag 'path' do %>
    <input type="search" name="search" id="search" placeholder="Search">
    <input list="headings" name="filter" placeholder="Filter">
    <datalist id="headings">
      <option value="url">URL</option>
      <option value="vulnerabilities">Vulnerabilities</option>
      <option value="ciphers">Ciphers</option>
      <option value="ip_address">IP Address</option>
      <option value="load_balancer">Load Balancer</option>
    </datalist>
    <button type="submit" id="submit-search">
      <i class="fas fa-search fa-3x"></i>
    </button>
  <% end %>
</div>

<table>
  <thead>
    <tr>
      <th>URL</th>
      <th>Expiration</th>
      <th>Vulnerabilities</th>
      <th>Ciphers</th>
      <th>IP Address</th>
      <th>Load Balancer</th>
    </tr>
  </thead>
  <tbody>
    <% @certificates.each do |cert| %><tr>
      <td><%= cert.url %></td>
      <td><%= cert.expiration %></td>
      <td><% cert.vulnerabilities.each do |vuln| %>
        <p><%= vuln %></p>
      <% end %></td>
      <td><% cert.cipher_names.each do |cipher| %>
        <p><%= cipher %></p>
      <% end %></td>
      <td><%= cert.ip_address %></td>
      <td><%= cert.load_balancer_hostname %></td>
    </tr><% end %>
  </tbody>
</table>
